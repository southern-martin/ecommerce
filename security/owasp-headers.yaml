# OWASP recommended security headers for API gateway / reverse proxy
headers:
  X-Content-Type-Options: nosniff
  X-Frame-Options: DENY
  X-XSS-Protection: "1; mode=block"
  Strict-Transport-Security: "max-age=31536000; includeSubDomains"
  Content-Security-Policy: "default-src 'self'"
  Referrer-Policy: strict-origin-when-cross-origin
  Permissions-Policy: "camera=(), microphone=(), geolocation=()"
  Cache-Control: "no-store, no-cache, must-revalidate"

rate_limiting:
  auth_endpoints:
    path: /api/v1/auth/*
    rate: 10/minute
    burst: 5
  ai_endpoints:
    path: /api/v1/ai/*
    rate: 30/minute
    burst: 10
  general:
    path: /api/v1/*
    rate: 100/minute
    burst: 50

cors:
  allowed_origins:
    - https://shop.example.com
    - http://localhost:5173
  allowed_methods: [GET, POST, PUT, PATCH, DELETE, OPTIONS]
  allowed_headers: [Authorization, Content-Type, X-Currency, Accept-Language, X-User-ID]
  max_age: 86400
